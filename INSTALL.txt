.. -*- mode: rst -*-

***************
Installing MAAS
***************

There are two main ways to install MAAS:

 * as part of a fresh Ubuntu install using the Ubuntu Server installer
 * or from Ubuntu's archive on an existing Ubuntu install.

This is a guide to installing MAAS from the Ubuntu archive.

It assumes that you're working with:

 * a fresh Ubuntu 12.04 LTS install
 * a machine dedicated to running MAAS
 * control of the network your machine is connected to
 * internet access or a local mirror of the Ubuntu archive.


Installing MAAS from the archive
================================

Installing MAAS is straightforward. At the command-line, type::

  $ sudo apt-get install maas

From a fresh Ubuntu 12.04 LTS install, MAAS will pull down around 200
MB of packages.


Creating a superuser account
----------------------------

Once MAAS is installed, you'll need to create your first administrator
account::

  $ maas createsuperuser

Follow the prompts and MAAS will create an admin account that you can
later use to log in.


Configuring a DHCP server
=========================

MAAS requires a properly configured DHCP server so it can boot machines using
PXE.  MAAS works with the ISC DHCP server; install it if it's not already
installed::

    $ sudo apt-get install isc-dhcp-server

There is a tool to generate a configuration for it that will work with MAAS::

    $ maas-provision generate-dhcp-config [options]

Run ``maas-provision generate-dhcp-config -h`` to see the options.  You will
need to provide various IP details such as the range of IP addresses to assign
to clients.  You can use the generated output to configure your system's ISC
DHCP server, by putting the configuration in the ``/etc/dhcp/dhcpd.conf`` file.

Now restart dhcpd::

  $ sudo /etc/init.d/isc-dhcp-server restart


Import the Ubuntu images
========================

MAAS will check for and download new Ubuntu images once a week.
However, you'll need to download them manually the first time::

  $ sudo maas-import-pxe-files

If you are using an HTTP proxy, bear in mind that the "sudo" will not
pass your http_proxy environment variable on to the script.  If that is
a problem, pass it on explicitly::

  $ sudo http_proxy=$http_proxy maas-import-pxe-files


SSL Support
===========

If you want secure access to your MAAS web UI/API, you need to do a few
things. First, turn on SSL support in Apache::

  $ sudo a2enmod ssl

Ensure that the Apache config file from ``etc/maas/maas-http.conf`` is
included in ``/etc/apache2/conf.d/``, then edit
``/etc/maas/maas_local_settings.py`` and change DEFAULT_MAAS_URL so that it
uses https instead of http.

Now, restart Apache::

  $ sudo service apache2 restart

At this point you will be able to access the MAAS web server using https but
the default SSL certificate is insecure.  Please generate your own and then
edit ``/etc/apache2/conf.d/maas-http.conf`` to set the location of the
certificate.


Next steps
==========

Your MAAS is now ready for use. Visit the MAAS web interface in your
browser at http://localhost/MAAS.

Now, :doc:`let's prepare your Juju environment <juju-quick-start>`.
