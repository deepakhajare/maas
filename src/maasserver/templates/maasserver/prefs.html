{% extends "maasserver/base.html" %}

{% block nav-active-prefs %}active{% endblock %}
{% block title %}User preferences for {{ user.username }}{% endblock %}
{% block page-title %}User preferences for {{ user.username }}{% endblock %}

{% block head %}
  <script type="text/javascript">
  <!--
  YUI().use('maas.prefs', function (Y) {
    var profile_widget = new Y.maas.prefs.TokenWidget(
        {'srcNode': Y.one('#api')});
    profile_widget.render();
  });
  // -->
  </script>
{% endblock %}

{% block content %}
  <div id="prefs">
    <div id="api" class="block size7 first">
      <h2>Keys</h2>
      <h3>MaaS keys</h3>
      <ul class="list">
        {% for token in user.get_profile.get_authorisation_tokens %}
          <li class="bundle">
            <a href="#" class="delete-link icon right">
              <img title="Delete MaaS key"
                   src="{{ STATIC_URL }}img/delete.png" />
            </a>
            <input type="text" 
                   value="{{ token.consumer.key }}:{{ token.key }}:{{ token.secret }}" 
                   id="{{ token.key }}"
                   class="disabled" />
          </li>
        {% endfor %}
      </ul>
      <p id="token_creation_placeholder" />
    </div>
    <div id="profile" class="block size7 first">
      <h2>User details</h2>
      <form action="." method="post">
        <ul>
          {% for field in profile_form %}
            {% include "maasserver/form_field.html" %}
	  {% endfor %}
	</ul>
        <input type="hidden" name="profile_submit" value="1" />
        <input type="submit" class="button right" value="Save" />
      </form>
    </div>
    <div id="password" class="block size7 first">
      <h2>Password</h2>
      <form action="." method="post">
        <ul>
          {% for field in password_form %}
            {% include "maasserver/form_field.html" %}
          {% endfor %}
        </ul>
        <input type="hidden" name="password_submit" value="1" />
        <input type="submit" class="button right" value="Change password" />
      </form>
    </div>
  </div>
{% endblock %}
